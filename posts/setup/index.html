<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<style type=text/css>body{font-family:monospace;}</style>
	<title>Hugo setup</title>
	
	
	<link rel="stylesheet" href="/css/style.css">
	
	
</head>
<body>
	<header>
	===============<br>
	== <a href="https://hjhp.github.io/">Hugo Poon</a> ==<br>
	===============
	<div style="float: right;"></div><br>
	<p>
	<nav>
			<a href="/"><b>Start</b></a>.
			
			
			<a href="/about/"><b>About</b></a>.
			
			<a href="/posts/"><b>Posts</b></a>.
			
	</nav>
	</p>
	
</header>

	
	<main>
		<article>
			<h1>Hugo setup</h1>
			<b><time>2021-05-29 13:15:51</time></b>
		       
            <hr>
			<div>
				<h1 id="introduction">Introduction</h1>
<p>Github Pages, where this site is hosted, recommends Jekyll, but by the name alone it&rsquo;s clear that Hugo is far superior.</p>
<p>This is based on <a href="https://youngkin.github.io/post/createafreeblogsite/#create-a-basic-site">Rich Youngkin&rsquo;s 2020-08-31 guide</a></p>
<h1 id="my-system">My system</h1>
<p>This was written based on a setup on macOS Big Sur 11.3.1.</p>
<h1 id="installation">Installation</h1>
<pre><code>brew install hugo
</code></pre><h1 id="new-site-setup">New site setup</h1>
<p>I used the <a href="https://github.com/colorchestra/smol">Smol</a> theme.</p>
<pre><code># Make the site
SITEDIR=./hugo
hugo new site $SITEDIR

# Install a theme
THEMEZIP=https://github.com/colorchestra/smol/archive/refs/heads/master.zip
THEMENAME=smol
cd themes
curl $THEMEZIP &gt; $THEMENAME.zip
unzip $THEMENAME.zip
rm $THEMENAME.zip

# Make a test file to check everything works
cd $SITEDIR
hugo new test.md
echo 'Testing' &gt;&gt; content/test.md

# Launch Hugo server
hugo server -D
</code></pre><p>By default, Hugo serves at <a href="http://localhost:1313/">http://localhost:1313/</a>.</p>
<h1 id="layout-modification">Layout modification</h1>
<h2 id="defining-a-homepage">Defining a homepage</h2>
<p>Smol&rsquo;s default is for the homepage to be a list of recent posts. My intention was for the blog part only to be a subsection of the website, with a less focused homepage.</p>
<p>In the absence of <code>$SITEDIR/layouts/index.html</code>, Hugo looks to <code>$SITEDIR/themes/$THEMENAME/layouts/index.html</code>.</p>
<p>I find it best practice not to modify the theme files directly: this means you can easily revert back to a known working original if you make a wrong edit. The solution, then, is simple:</p>
<pre><code>cp $SITEDIR/themes/$THEMENAME/layouts/index.html $SITEDIR/layouts/index.html
</code></pre><p>Then edit <code>$SITEDIR/layouts/index.html</code>.</p>
<h2 id="changing-single-layouts">Changing &ldquo;single&rdquo; layouts</h2>
<p>I don&rsquo;t like the way Smol presents single pages: there isn&rsquo;t enough visual separation between the post title (generated by frontmatter) and the section headings in the post body, so I added <code>&lt;hr&gt;</code> after the date.</p>
<p>Similar to a custom <code>index.html</code>, the <code>single.html</code> template can be copied, and the new version edited:</p>
<pre><code>mkdir -p $SITEDIR/layouts/_default/
cp $SITEDIR/themes/$THEMENAME/layouts/_default/single.html $SITEDIR/layouts/_default/single.html
</code></pre><h1 id="configuring-github">Configuring Github</h1>
<p>The concept is to have 2 repositories:</p>
<ol>
<li>A private repo for <code>$SITEDIR</code>.
<ul>
<li>Do not link this to <code>$GITUSERNAME.github.io</code>, since we do not want to serve the contents of <code>$SITEDIR</code> to the public.</li>
</ul>
</li>
<li>A public repo for <code>$SITEDIR/public</code>, which is where Hugo stores the generated files.
<ul>
<li>This is the only folder that needs to be served to the public, and is therefore the folder that will be linked to the <code>$GITUSERNAME.github.io</code> repository.</li>
</ul>
</li>
</ol>
<p>Since <code>public</code> is inside <code>$SITEDIR</code>, we use a normal repo for <code>$SITEDIR</code>, but a <a href="https://github.blog/2016-02-01-working-with-submodules/">submodule</a> repo for <code>$SITEDIR/public</code>.</p>
<h2 id="adding-the-private-repo">Adding the private repo</h2>
<p>Configuring the <code>$SITEDIR</code> repo is like any other git repo.</p>
<pre><code>git init
git commit -m &quot;first commit&quot;
git branch -M main
git remote add origin &lt;sshURL&gt;
git push -u origin main
</code></pre><h2 id="adding-the-submodule">Adding the submodule</h2>
<pre><code>cd $SITEDIR/public
git init
git commit -m &quot;first commit&quot;
git branch -M main
git remote add origin &lt;sshURL&gt;
git push -u origin main
cd $SITEDIR
git submodule add -b main git@hjhp.github.io.git public
</code></pre><h1 id="quirks">Quirks</h1>
<h2 id="about-page">&ldquo;About&rdquo; page</h2>
<p>Suppose you have the file <code>$SITEDIR/content/about.md</code> and you want this page linked in your menubar. Then <code>config.toml</code> should contain the below:</p>
<pre><code># Header
[menu]
  [[menu.main]]
        identifier = &quot;about&quot;
        name = &quot;About&quot;
        url = &quot;/about/&quot;
        weight = 1 
</code></pre><p>Under <code>hugo server -D</code>, the behaviour is as expected: clicking on &ldquo;About&rdquo; in the menubar loads <code>http://localhost:1313/about/</code> which contains, as body text, the contents of <code>about.md</code>.</p>

			</div>
		</article>
	</main>
<aside>
	<div>
		<div>
			<h3>LATEST POSTS</h3>
		</div>
		<div>
			<ul>
				
				<li><a href="/posts/setup/">Hugo setup</a></li>
				
			</ul>
		</div>
	</div>
</aside>


	<footer>
	<p>&copy; 2021 <a href="https://hjhp.github.io/"><b>Hugo Poon</b></a>.
	</p>
</footer>

</body>
</html>
